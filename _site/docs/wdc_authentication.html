<!DOCTYPE html>
<html>

<head>
      <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v -->



<meta name="generator" content="Jekyll v4.3.2" />





<meta property="og:locale" content="" />

  <link rel="shortcut icon" type="image/png" href="/webdataconnector/assets/logo.png">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="/webdataconnector/assets/css/main.css">
  <link rel="stylesheet" href="/webdataconnector/assets/css/github-highlight.css">

  <script src="/webdataconnector/assets/js/redirect-to-search.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>



</head>

<body>
    <div class="container">
        <header class="site-header">
  <div class="wrapper">
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand navbar-brand-logo" href="/webdataconnector/#">Tableau Web Data Connector</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/webdataconnector/docs/index.html">Docs</a></li>
            <li><a href="/webdataconnector/docs/api_ref.html">API Reference</a></li>
            <li><a href="/webdataconnector/community/">Community Connectors</a></li>
            <li><a target="_blank" href="https://community.tableau.com/s/topic/0TO4T000000QFBJWA4/web-data-connector">Forum</a></li>
            <li><a href="/webdataconnector/news/">What's New?</a></li>
            
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="tableauIcon"><a target="_blank" href="http://tableau.com"><img src="/webdataconnector/assets/logo.png" alt="Tableau Developers" class="logo" /></a></li>
            <li><a target="_blank" href="https://github.com/tableau/webdataconnector"><span class="icon icon--github" title="WDC on GitHub" alt="WDC on GitHub"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span></a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  </div>
</header>

        <div class="well docs-menu col-xs-12 col-sm-4 col-md-3">
    <div class="search-container form-group has-feedback">
    <form id="docs-search">
        <input type="search" id="search-input" class="custom-search form-control" placeholder="Search the docs..." search-url="/webdataconnector/docs/search.html">
        <span class="glyphicon glyphicon-search form-control-feedback"></span>
    </form>
</div>


    <ul class="nav nav-list">
        <li class="nav-header">Overview</li>
        <li>
            <a href="/webdataconnector/docs/index.html">Get Started</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_tutorial.html">Tutorial</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_use_in_tableau.html">Use a WDC in Tableau Desktop</a>
        </li>
		<li>
            <a href="/webdataconnector/docs/wdc_use_in_server.html">Use a WDC in Tableau Server</a>
        </li>

        <li class="nav-header">Basic Concepts</li>
        <li>
            <a href="/webdataconnector/docs/wdc_phases.html">Lifecycle and Phases</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_library_versions.html">API Versions</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_samples.html">Samples</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_debugging.html">Debugging in the Simulator and Tableau</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_hosting_and_submissions.html">Hosting and Submitting to Community Portal</a>
        </li>

        <li class="nav-header">Advanced Concepts</li>
        <li>
            <a href="/webdataconnector/docs/wdc_multi_table_tutorial.html">Multiple Tables Tutorial</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_oauth_tutorial.html">Node.js Proxy with OAuth Tutorial</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_standard_connections.html">Standard Connections</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_join_filtering.html">Join Filtering</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_custom_init_and_shutdown.html">Custom Initialization and Shutdown</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_get_data.html">Get Data: Best Practices</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_incremental_refresh.html">Incremental Refresh</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_authentication.html">Authentication</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_cors.html">Working with CORS</a>
        </li>

        <li class="nav-header">Reference</li>
        <li>
            <a href="/webdataconnector/docs/wdc_resources.html">Resources</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_ref_date_formats.html">Supported Date Formats</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_faq.html">FAQ</a>
        </li>
		    <li>
		    <a href="/webdataconnector/docs/wdc_upgrade.html">Upgrading from WDC Version 1.x</a>
        </li>
        <li>
		    <a href="/webdataconnector/docs/wdc_webengine.html">Troubleshoot WDC WebEngine Issues</a>
		   </li>
           <li>
		    <a href="/webdataconnector/docs/wdc_about.html">About Tableau Help</a>
		   </li>
    </ul>
</div>


        <div class="content .col-xs-12 .col-sm-8 .col-md-9">
            <h1>WDC Authentication</h1>
            <div class="alert alert-info"><p><strong>Important</strong>: Tableau Web Data Connector 2.0 (this version) is being deprecated at Tableau 2023.1 and eventually retired. We will still support WDC 2.0 until its last compatible version of Tableau (Tableau 2022.4) goes End of Life and is no longer supported.</p>

            <p>For information about Tableau Web Data Connector 3.0, see the <a href="https://help.tableau.com/current/api/webdataconnector/en-us/index.html">WDC 3.0 documentation</a>.</p>
            </div>
            <div class="edit-container">
                <a href="https://github.com/tableau/webdataconnector/edit/master/docs/wdc_authentication.md" class="edit-links"><span class="glyphicon glyphicon-pencil"></span> Edit this page</a>
                &nbsp;
                <a href="https://github.com/tableau/webdataconnector/issues" class="edit-links"><span class="glyphicon glyphicon-flag"></span> Submit an issue</a>
            </div>
            <br />
            <p>Many connectors require authentication to connect to a data source.
For these connectors, you must handle authentication in your connector code and create a form interface to prompt users for authentication information.
Separately, the WDC also includes logic that you can use for re-authentication as a convenience.
This topic describes how to re-authenticate users for connectors that have already run.</p>

<div class="alert alert-info">
    <b>Note:</b> Kerberos is currently not supported with a custom Web Data Connector.
</div>

<ul id="markdown-toc">
  <li><a href="#auth-types" id="markdown-toc-auth-types">Types of authentication</a></li>
  <li><a href="#auth-phase" id="markdown-toc-auth-phase">The WDC Auth Phase</a></li>
  <li><a href="#auth-purpose" id="markdown-toc-auth-purpose">Advanced: Auth Purpose Mechanism</a></li>
  <li><a href="#server-auth" id="markdown-toc-server-auth">Advanced: Authentication on Server</a></li>
</ul>

<h2 id="auth-types">Types of authentication</h2>

<p>Authentication types are used to help users re-authenticate.
The WDC API supports the following authentication types:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">basic</code>. User name and password authentication.</li>
  <li><code class="language-plaintext highlighter-rouge">custom</code>. Other authentication methods, including OAuth for example.</li>
  <li><code class="language-plaintext highlighter-rouge">none</code>. No authentication is required. If you do not specify an authentication type, <code class="language-plaintext highlighter-rouge">none</code> is assumed.</li>
</ul>

<p>A connector should set its auth type in a custom init method.
For example:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Init function for connector, called during every phase</span>
  <span class="nx">myConnector</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">initCallback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">tableau</span><span class="p">.</span><span class="nx">authType</span> <span class="o">=</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">authTypeEnum</span><span class="p">.</span><span class="nx">custom</span><span class="p">;</span>
      <span class="nf">initCallback</span><span class="p">();</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>For connectors that require authentication, the auth type must be set.  Otherwise,
Tableau will not know how to re-authenticate the user when the user is un-authenticated, which is a common scenario.
For example, passwords (or tokens) should be stored in the tableau.password property.  The contents of this property
are not ever written to disk.  So when a user opens a saved workbook that is attached to a WDC data source,
there will not a be a password for that source.</p>

<p>In that case, if the user wishes to refresh the extract, re-authentication needs to happen first.  When
the user tries to refresh the data source, one of three things can happen depending on the value of authType.</p>

<ul>
  <li>
    <p>If authType is <code class="language-plaintext highlighter-rouge">none</code>, then nothing will happen.</p>
  </li>
  <li>
    <p>If authType is <code class="language-plaintext highlighter-rouge">basic</code>, Tableau will show a standard username/password dialog.</p>

    <p><img class="img-responsive docs-img" src="/webdataconnector/assets/wdc_basic_auth.png" alt="" /></p>
  </li>
  <li>
    <p>If authType is <code class="language-plaintext highlighter-rouge">custom</code>, Tableau will launch the web data connector in a special Auth Phase (see the following section).</p>
  </li>
</ul>

<p>After that, the tableau.username and tableau.password property will both have values, and the extract
can now be refreshed.</p>

<p><strong><em>Note</em></strong>: authType in part replaced alwaysShowAuthUI from version 1 of the API.</p>

<h2 id="auth-phase">The WDC Auth Phase</h2>
<p>The WDC has two primary phases, as described in the <a href="/webdataconnector/docs/wdc_phases.html">WDC Lifecycle and Phases</a>
section.  But there is a third phase that is only relevant for WDCs that use an auth type of <code class="language-plaintext highlighter-rouge">custom</code>. 
The auth phase is more of an alternative to the interactive phase than a separate phase.</p>

<p>The auth phase will be displayed by Tableau in two scenarios:</p>

<ul>
  <li>
    <p>The WDC uses authType <code class="language-plaintext highlighter-rouge">custom</code>, the current user is un-authenticated (as described above, 
when opening an existing workbook), and the user attempts to refresh the extract or edit the connection.</p>
  </li>
  <li>
    <p>The WDC developer calls <a href="/webdataconnector/docs/api_ref.html#webdataconnectorapi.tableau.abortforauth">tableau.abortForAuth</a>.</p>

    <p>This method is provided so that the developer can explicitly tell Tableau the current user is un-authenticated.
  For example, this can be helpful when working with OAuth. In some scenarios, the access token used to get resources
  from an API can expire or be revoked.  In that scenario, before fetching data, the WDC would want to call this method
  in order to re-authenticate the user. For more information, see the <strong>OAuthProxyExample</strong> connector included in the SDK.</p>

    <p><strong>IMPORTANT:</strong> The <code class="language-plaintext highlighter-rouge">abortForAuth</code> function must be called from the <code class="language-plaintext highlighter-rouge">init</code> method during the gather data phase. One intended scenario for this function is when a user, who has not been authenticated, opens an existing workbook and attempts to refresh data. In this case, the auth token is no longer available.</p>
  </li>
</ul>

<p>In the auth phase of the WDC, any changes to properties other than <code class="language-plaintext highlighter-rouge">tableau.password</code> and <code class="language-plaintext highlighter-rouge">tableau.username</code> will
be ignored.  Thus, it is a best practice to only show the UI that is necessary to re-authenticate the user,
and then auto-submit the connector for the user once they have been authenticated.
For example, in the <strong>OAuthProxyExample</strong> this is how this
is handled in the custom init method:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Init function for connector, called during every phase but</span>
  <span class="c1">// only called when running inside the simulator or tableau</span>
  <span class="nx">myConnector</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">initCallback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">tableau</span><span class="p">.</span><span class="nx">authType</span> <span class="o">=</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">authTypeEnum</span><span class="p">.</span><span class="nx">custom</span><span class="p">;</span>

      <span class="c1">// If we are in the auth phase we only want to show the UI needed for auth</span>
      <span class="nf">if </span><span class="p">(</span><span class="nx">tableau</span><span class="p">.</span><span class="nx">phase</span> <span class="o">==</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">phaseEnum</span><span class="p">.</span><span class="nx">authPhase</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#getvenuesbutton</span><span class="dl">"</span><span class="p">).</span><span class="nf">css</span><span class="p">(</span><span class="dl">'</span><span class="s1">display</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="nf">if </span><span class="p">(</span><span class="nx">tableau</span><span class="p">.</span><span class="nx">phase</span> <span class="o">==</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">phaseEnum</span><span class="p">.</span><span class="nx">gatherDataPhase</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// If the API that WDC is using has an endpoint that checks</span>
        <span class="c1">// the validity of an access token, that could be used here.</span>
        <span class="c1">// Then the WDC can call tableau.abortForAuth if that access token</span>
        <span class="c1">// is invalid.</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">accessToken</span> <span class="o">=</span> <span class="nx">Cookies</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">accessToken</span><span class="dl">"</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Access token is '</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">accessToken</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">'</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">hasAuth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">accessToken</span> <span class="o">&amp;&amp;</span> <span class="nx">accessToken</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">password</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nf">updateUIWithAuthState</span><span class="p">(</span><span class="nx">hasAuth</span><span class="p">);</span>

      <span class="nf">initCallback</span><span class="p">();</span>

      <span class="c1">// If we are not in the data gathering phase, we want to store the token</span>
      <span class="c1">// This allows us to access the token in the data gathering phase</span>
      <span class="nf">if </span><span class="p">(</span><span class="nx">tableau</span><span class="p">.</span><span class="nx">phase</span> <span class="o">==</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">phaseEnum</span><span class="p">.</span><span class="nx">interactivePhase</span> <span class="o">||</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">phase</span> <span class="o">==</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">phaseEnum</span><span class="p">.</span><span class="nx">authPhase</span><span class="p">)</span> <span class="p">{</span>
          <span class="nf">if </span><span class="p">(</span><span class="nx">hasAuth</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">tableau</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="nx">accessToken</span><span class="p">;</span>

              <span class="nf">if </span><span class="p">(</span><span class="nx">tableau</span><span class="p">.</span><span class="nx">phase</span> <span class="o">==</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">phaseEnum</span><span class="p">.</span><span class="nx">authPhase</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Auto-submit here if we are in the auth phase</span>
                <span class="nx">tableau</span><span class="p">.</span><span class="nf">submit</span><span class="p">()</span>
              <span class="p">}</span>

              <span class="k">return</span><span class="p">;</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">};</span>
</code></pre></div></div>

<h2 id="auth-purpose">Advanced: Auth Purpose Mechanism</h2>
<p>Understanding the content in the <strong>OAuthProxyExample</strong> included with the SDK is
recommended before proceeding on with this or the following section. See the <a href="/webdataconnector/docs/wdc_oauth_tutorial.html">Node.js Proxy with OAuth Tutorial</a> for more information. The tutorial contains helpful terminology that is used without explanation here.</p>

<p>Specifically for data sources that use OAuth as an authorization mechanism, there is a special enum in the API that can be useful for making a highly scalable connector.  This is an advanced technique
and can be safely ignored in many scenarios.</p>

<p>The motivation for this property stems from the fact that many OAuth providers only allow a limited
number of access tokens to be valid at a given time.  For example, certain OAuth providers allow 25 
access tokens to be valid for a given user/client pair.  If a 26th access token were to be issued, the 1st access
token would become invalid.  For certain OAuth providers, this number may be even smaller.  We have seen OAuth providers that only allow
1 access token to be valid at a given time for any user/client pair.</p>

<p>Given this, the following scenario could occur if the WDC was using a source that only allowed one valid access token:</p>

<ul>
  <li>
    <p>A user creates a data source with your WDC (1 access token is created and associated with that data source).</p>
  </li>
  <li>
    <p>The user publishes the data source to Server and enables automatic refreshes.</p>
  </li>
  <li>
    <p>The user creates a second data source (2nd access token is created, rendering the first one invalid).</p>
  </li>
  <li>
    <p>The automatic refresh on server would now fail because the associated access token is invalid.</p>
  </li>
</ul>

<p>In order to get around this problem, you can associate all data sources created from Tableau Desktop with
a given client, and all data sources refreshed on Tableau Server with another client.  To do this, in your WDC
you can use the <a href="/webdataconnector/docs/api_ref.html#webdataconnectorapi.tableau.authpurpose">tableau.authPurpose</a>
to read which context your WDC is currently running in.  If that context is <code class="language-plaintext highlighter-rouge">ephemeral</code> then the WDC is 
being run from Tableau Desktop.  If the context is <code class="language-plaintext highlighter-rouge">enduring</code>, then the WDC is being run on Tableau Server during
an automated refresh.  You can use this property to set the client ID appropriately when performing OAuth flows.</p>

<p>It is also important that your connector sets the <code class="language-plaintext highlighter-rouge">tableau.username</code> property to be whatever identity is associated with an access token (most commonly an email or username).  This will allow Tableau to share access
tokens between data sources on Server so that even if the OAuth provider restricts you to n valid access tokens, you can support more than n data sources.</p>

<h2 id="server-auth">Advanced: Authentication on Server</h2>
<p>Currently, there is no way to re-authenticate a data source from Tableau Server directly.</p>

<p>For example, if you build a connector that uses OAuth as an authorization mechanism, each data source
will have an associated access token.  But these access tokens can expire, 
and when that happens, the data source would no longer be usable.</p>

<p>Luckily, with OAuth (and often there is a parallel with other types of authorization and authentication mechanisms),
there is a way to refresh these access tokens programmatically.  For OAuth specifically, we recommend
fully implementing the refresh flow so that when an access token expires, the refresh token
can be used to get a new, valid access token.</p>

            <!-- Footer -->
<footer>
    <div class="row">
            <hr class="footer-hr">
            <p>This site is open source. Suggestions and pull requests are welcome on our <a href="https://github.com/tableau/webdataconnector">GitHub page</a>.</p>
            <p><a href="https://www.tableau.com/en-us/legal" class="aLegal">LEGAL</a> <a href="https://www.salesforce.com/company/privacy/" class="aLegal">PRIVACY</a> &copy; 2003&ndash;<script>document.write(new Date().getFullYear())</script> TABLEAU SOFTWARE LLC. ALL RIGHTS RESERVED</p>
            <sub>Documentation last generated on: 2023-03-07 13:27:13 -0800</sub>
    </div>
</footer>

        </div>
    </div>
</body>

</html>
