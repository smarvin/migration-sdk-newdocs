<!DOCTYPE html>
<html>

<head>
      <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v -->



<meta name="generator" content="Jekyll v4.3.2" />





<meta property="og:locale" content="" />

  <link rel="shortcut icon" type="image/png" href="/webdataconnector/assets/logo.png">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="/webdataconnector/assets/css/main.css">
  <link rel="stylesheet" href="/webdataconnector/assets/css/github-highlight.css">

  <script src="/webdataconnector/assets/js/redirect-to-search.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>



</head>

<body>
    <div class="container">
        <header class="site-header">
  <div class="wrapper">
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand navbar-brand-logo" href="/webdataconnector/#">Tableau Web Data Connector</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/webdataconnector/docs/index.html">Docs</a></li>
            <li><a href="/webdataconnector/docs/api_ref.html">API Reference</a></li>
            <li><a href="/webdataconnector/community/">Community Connectors</a></li>
            <li><a target="_blank" href="https://community.tableau.com/s/topic/0TO4T000000QFBJWA4/web-data-connector">Forum</a></li>
            <li><a href="/webdataconnector/news/">What's New?</a></li>
            
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="tableauIcon"><a target="_blank" href="http://tableau.com"><img src="/webdataconnector/assets/logo.png" alt="Tableau Developers" class="logo" /></a></li>
            <li><a target="_blank" href="https://github.com/tableau/webdataconnector"><span class="icon icon--github" title="WDC on GitHub" alt="WDC on GitHub"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span></a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  </div>
</header>

        <div class="well docs-menu col-xs-12 col-sm-4 col-md-3">
    <div class="search-container form-group has-feedback">
    <form id="docs-search">
        <input type="search" id="search-input" class="custom-search form-control" placeholder="Search the docs..." search-url="/webdataconnector/docs/search.html">
        <span class="glyphicon glyphicon-search form-control-feedback"></span>
    </form>
</div>


    <ul class="nav nav-list">
        <li class="nav-header">Overview</li>
        <li>
            <a href="/webdataconnector/docs/index.html">Get Started</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_tutorial.html">Tutorial</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_use_in_tableau.html">Use a WDC in Tableau Desktop</a>
        </li>
		<li>
            <a href="/webdataconnector/docs/wdc_use_in_server.html">Use a WDC in Tableau Server</a>
        </li>

        <li class="nav-header">Basic Concepts</li>
        <li>
            <a href="/webdataconnector/docs/wdc_phases.html">Lifecycle and Phases</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_library_versions.html">API Versions</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_samples.html">Samples</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_debugging.html">Debugging in the Simulator and Tableau</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_hosting_and_submissions.html">Hosting and Submitting to Community Portal</a>
        </li>

        <li class="nav-header">Advanced Concepts</li>
        <li>
            <a href="/webdataconnector/docs/wdc_multi_table_tutorial.html">Multiple Tables Tutorial</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_oauth_tutorial.html">Node.js Proxy with OAuth Tutorial</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_standard_connections.html">Standard Connections</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_join_filtering.html">Join Filtering</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_custom_init_and_shutdown.html">Custom Initialization and Shutdown</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_get_data.html">Get Data: Best Practices</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_incremental_refresh.html">Incremental Refresh</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_authentication.html">Authentication</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_cors.html">Working with CORS</a>
        </li>

        <li class="nav-header">Reference</li>
        <li>
            <a href="/webdataconnector/docs/wdc_resources.html">Resources</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_ref_date_formats.html">Supported Date Formats</a>
        </li>
        <li>
            <a href="/webdataconnector/docs/wdc_faq.html">FAQ</a>
        </li>
		    <li>
		    <a href="/webdataconnector/docs/wdc_upgrade.html">Upgrading from WDC Version 1.x</a>
        </li>
        <li>
		    <a href="/webdataconnector/docs/wdc_webengine.html">Troubleshoot WDC WebEngine Issues</a>
		   </li>
           <li>
		    <a href="/webdataconnector/docs/wdc_about.html">About Tableau Help</a>
		   </li>
    </ul>
</div>


        <div class="content .col-xs-12 .col-sm-8 .col-md-9">
            <h1>WDC Tutorial</h1>
            <div class="alert alert-info"><p><strong>Important</strong>: Tableau Web Data Connector 2.0 (this version) is being deprecated at Tableau 2023.1 and eventually retired. We will still support WDC 2.0 until its last compatible version of Tableau (Tableau 2022.4) goes End of Life and is no longer supported.</p>

            <p>For information about Tableau Web Data Connector 3.0, see the <a href="https://help.tableau.com/current/api/webdataconnector/en-us/index.html">WDC 3.0 documentation</a>.</p>
            </div>
            <div class="edit-container">
                <a href="https://github.com/tableau/webdataconnector/edit/master/docs/wdc_tutorial.md" class="edit-links"><span class="glyphicon glyphicon-pencil"></span> Edit this page</a>
                &nbsp;
                <a href="https://github.com/tableau/webdataconnector/issues" class="edit-links"><span class="glyphicon glyphicon-flag"></span> Submit an issue</a>
            </div>
            <br />
            <blockquote>
  <p>This tutorial picks up where the <a href="/webdataconnector/docs">Get Started</a> topic left off. If you haven’t already, go
back and set up your development environment.</p>
</blockquote>

<p>By the end of this tutorial, you’ll have a working WDC that connects to the <a href="http://earthquake.usgs.gov/earthquakes/feed/v1.0/index.php">USGS Earthquake
feed</a> and downloads data for earthquakes that occurred in
the last week.</p>

<p>You’ll learn how to:</p>

<ul id="markdown-toc">
  <li><a href="#create-the-html-page" id="markdown-toc-create-the-html-page">Create the HTML page</a></li>
  <li><a href="#create-the-connector-object" id="markdown-toc-create-the-connector-object">Create the connector object</a></li>
  <li><a href="#add-an-event-listener" id="markdown-toc-add-an-event-listener">Add an event listener</a></li>
  <li><a href="#test-the-connector-so-far" id="markdown-toc-test-the-connector-so-far">Test the connector so far</a></li>
  <li><a href="#define-a-schema" id="markdown-toc-define-a-schema">Define a schema</a></li>
  <li><a href="#get-the-data" id="markdown-toc-get-the-data">Get the data</a></li>
  <li><a href="#see-it-in-action" id="markdown-toc-see-it-in-action">See it in action</a></li>
</ul>

<p>If you <em>really</em> want to skip all of this and go straight to the source code, look for the <code class="language-plaintext highlighter-rouge">earthquakeUSGS</code> files in the
<code class="language-plaintext highlighter-rouge">Examples</code> directory. You’ll get a lot more out of this if you build it from scratch though–promise!</p>

<p><strong>Note</strong>: The connector that we’ll create in this tutorial (<code class="language-plaintext highlighter-rouge">earthquakeWDC</code>) has a different name than the same
connector in the <code class="language-plaintext highlighter-rouge">Examples</code> directory (<code class="language-plaintext highlighter-rouge">earthquakeUSGS</code>). This is to minimize the chances of accidentally overwriting
the existing sample. However, if you copy the existing sample, you’ll have to change file paths.</p>

<p><strong>Note</strong>: The browser used inside Tableau Desktop 2019.3 and earlier is QT WebKit, which does not natively support new ES6 features.  If you wish to take advantage of newer features (such as promises) when building WDCs for older versions of Tableau you will need to use a polyfill.</p>

<h3 id="create-the-html-page">Create the HTML page</h3>

<p>When you open a WDC in Tableau, you display an HTML page that links to your JavaScript code and to the WDC library.
Optionally, this page can also display a user interface for your users to select the data that they want to download.</p>

<p>Create a new file named <code class="language-plaintext highlighter-rouge">earthquakeWDC.html</code> and save it in the top-level directory of the <code class="language-plaintext highlighter-rouge">webdataconnector</code>
repository. (This is the same directory as the README.)</p>

<p>Then, copy the following code into the file:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>

<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>USGS Earthquake Feed<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"Cache-Control"</span> <span class="na">content=</span><span class="s">"no-store"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>

    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://connectors.tableau.com/libs/tableauwdc-2.3.latest.js"</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"earthquakeWDC.js"</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container container-table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row vertical-center-row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"text-center col-md-4 col-md-offset-4"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">id=</span><span class="s">"submitButton"</span> <span class="na">class=</span><span class="s">"btn btn-success"</span> <span class="na">style=</span><span class="s">"margin: 10px;"</span><span class="nt">&gt;</span>Get Earthquake Data!<span class="nt">&lt;/button&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>Let’s run through what the code is doing. Skipping over the standard markup for an HTML page, you’ll notice the
following between the <code class="language-plaintext highlighter-rouge">head</code> tags:</p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">meta</code> tag prevents your browser from caching the page.</li>
  <li>The <code class="language-plaintext highlighter-rouge">bootstrap.min.css</code> and <code class="language-plaintext highlighter-rouge">bootstrap.min.js</code> files are used to simplify styling and formatting.</li>
  <li>The <code class="language-plaintext highlighter-rouge">jquery.min.js</code> file will be used as a helper library by our connector. (For example, the connector uses jQuery to
get JSON data.)</li>
  <li>The <code class="language-plaintext highlighter-rouge">tableauwdc-2.3.latest.js</code> file is the main library for the WDC API.</li>
  <li>The <code class="language-plaintext highlighter-rouge">earthquakeWDC.js</code> file is the (not yet created) JavaScript code for our connector.</li>
</ul>

<p>Between the <code class="language-plaintext highlighter-rouge">body</code> tags, there is a simple button element that illustrates how users can interact with your connector
before getting data. In a later step, you’ll attach an event listener to the button in the JavaScript code.</p>

<h3 id="create-the-connector-object">Create the connector object</h3>

<p>Now that you’ve created a user interface, it’s time to write the JavaScript code for the connector. Create a new file
named <code class="language-plaintext highlighter-rouge">earthquakeWDC.js</code> and save it in the same directory as the <code class="language-plaintext highlighter-rouge">earthquakeWDC.html</code> file.</p>

<p>Copy the following code into the file to create the basic structure of the connector:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">myConnector</span> <span class="o">=</span> <span class="nx">tableau</span><span class="p">.</span><span class="nf">makeConnector</span><span class="p">();</span>

    <span class="nx">myConnector</span><span class="p">.</span><span class="nx">getSchema</span> <span class="o">=</span> <span class="nf">function </span><span class="p">(</span><span class="nx">schemaCallback</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">};</span>

    <span class="nx">myConnector</span><span class="p">.</span><span class="nx">getData</span> <span class="o">=</span> <span class="nf">function </span><span class="p">(</span><span class="nx">table</span><span class="p">,</span> <span class="nx">doneCallback</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">};</span>

    <span class="nx">tableau</span><span class="p">.</span><span class="nf">registerConnector</span><span class="p">(</span><span class="nx">myConnector</span><span class="p">);</span>
<span class="p">})();</span>
</code></pre></div></div>

<p>Some things to note about the code:</p>

<ul>
  <li>The code is wrapped in an immediately invoked function expression to create a local scope.</li>
  <li>The <code class="language-plaintext highlighter-rouge">tableau</code> object isn’t defined in our code, but in the WDC library. (It’s assigned to the global scope.)</li>
  <li>The <code class="language-plaintext highlighter-rouge">makeConnector</code> function is a constructor that predefines some methods for our connector object.</li>
  <li>The <code class="language-plaintext highlighter-rouge">getSchema</code> and <code class="language-plaintext highlighter-rouge">getData</code> functions are placeholders for now, but will contain the logic for getting the table
schema of the data and downloading the data.</li>
  <li>The <code class="language-plaintext highlighter-rouge">registerConnector</code> function validates the connector object before initialization.</li>
</ul>

<h3 id="add-an-event-listener">Add an event listener</h3>

<p>Remember how we added a button to the HTML page? It’s time to create an event listener that responds to clicking on the
button.</p>

<p>Copy the following code and paste it directly below the <code class="language-plaintext highlighter-rouge">registerConnector</code> function:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#submitButton</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">tableau</span><span class="p">.</span><span class="nx">connectionName</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">USGS Earthquake Feed</span><span class="dl">"</span><span class="p">;</span>
        <span class="nx">tableau</span><span class="p">.</span><span class="nf">submit</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Here’s what is going on in the code snippet:</p>

<ul>
  <li>The jQuery <code class="language-plaintext highlighter-rouge">$(document).ready</code> function runs some code when the page loads.</li>
  <li>An click event listener is added to the button element created earlier. The button is identified by the <code class="language-plaintext highlighter-rouge">submitButton</code>
id.</li>
  <li>The <code class="language-plaintext highlighter-rouge">tableau.connectionName</code> variable defines what we want to call the connector data source when it is displayed in
Tableau.</li>
  <li>The <code class="language-plaintext highlighter-rouge">tableau.submit()</code> function sends the connector object to Tableau for validation.</li>
</ul>

<p><strong>Tip</strong>: Not every connector needs a user interface. If you want a connector to run without user input, you can use
custom initialization code. For more information, see <a href="/webdataconnector/docs/wdc_custom_init_and_shutdown">Custom Initialization and Shutdown</a></p>

<h3 id="test-the-connector-so-far">Test the connector so far</h3>

<p>The connector doesn’t <em>do</em> very much so far, but it’s enough that we can run it in the simulator.</p>

<p><strong>Note</strong>: Have you followed the steps in the <a href="/webdataconnector/docs">Getting Started</a> topic to set up the simulator? This
section assumes that you’ve installed dependencies already.</p>

<ol>
  <li>
    <p>Open a command prompt or terminal in the top-level directory for the <code class="language-plaintext highlighter-rouge">webdataconnector</code> repository.</p>
  </li>
  <li>
    <p>Run <code class="language-plaintext highlighter-rouge">npm start</code> to run the test server.</p>
  </li>
  <li>
    <p>Open a browser and navigate to the following URL:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://localhost:8888/Simulator/index.html
</code></pre></div>    </div>
  </li>
  <li>
    <p>In the WDC URL field, enter the path to your WDC relative to the simulator. For example, if you created your WDC in
the top-level directory, you might enter:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>../earthquakeWDC.html
</code></pre></div>    </div>
  </li>
  <li>
    <p>Click the <strong>Start Interactive Phase</strong> button.
The connector page appears in a new window.</p>
  </li>
  <li>
    <p>Click <strong>Get Earthquake Data!</strong>.
The connector page closes.</p>
  </li>
</ol>

<p>At this point, you might be thinking “Well…did it work?” Let’s add a log message so that you can practice debugging
the connector.</p>

<h4 id="add-a-log-message-to-confirm-it-is-working-sort-of">Add a log message to confirm it is working (sort of)</h4>

<ol>
  <li>
    <p>In the <code class="language-plaintext highlighter-rouge">earthquakeWDC.js</code> file, copy the following code and replace the empty <code class="language-plaintext highlighter-rouge">myConnector.getSchema</code> function:</p>

    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">myConnector</span><span class="p">.</span><span class="nx">getSchema</span> <span class="o">=</span> <span class="nf">function </span><span class="p">(</span><span class="nx">schemaCallback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">tableau</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello WDC!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>    </div>
    <p>The <code class="language-plaintext highlighter-rouge">tableau.log</code> function allows you to pass messages from your connector back to the simulator. These log messages
are then printed with the browser’s built-in <code class="language-plaintext highlighter-rouge">console.log()</code> function on the simulator page.</p>
  </li>
  <li>Refresh the simulator page in your browser.</li>
  <li>Open your browser’s developer tools. For example, in Chrome you can press <strong>Ctrl+Shift+I</strong>.</li>
  <li>Click <strong>Start Interactive Phase</strong>.</li>
  <li>Click <strong>Get Earthquake Data!</strong>.</li>
</ol>

<p>If all goes well, you should see <code class="language-plaintext highlighter-rouge">Hello WDC!</code> in your browser’s console.</p>

<h3 id="define-a-schema">Define a schema</h3>

<p>So the connector is working now–sort of. Before you can download data and pass it to Tableau, you need to define how
you want to map the data to one or more or tables. This mapping of data is done in the schema.</p>

<p>To decide what data you want to map in the schema, you can take a look at the USGS description of the JSON data source:
<a href="http://earthquake.usgs.gov/earthquakes/feed/v1.0/geojson.php" target="_blank">GeoJSON Summary Format</a>. Rather than map all the data available from the
data source, this example has selected a focused subset.</p>

<p>When you’re done looking at the summary of the JSON data source, copy the following code into the <code class="language-plaintext highlighter-rouge">earthquakeWDC.js</code>
file and replace the placeholder <code class="language-plaintext highlighter-rouge">getSchema</code> function:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">myConnector</span><span class="p">.</span><span class="nx">getSchema</span> <span class="o">=</span> <span class="nf">function </span><span class="p">(</span><span class="nx">schemaCallback</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">cols</span> <span class="o">=</span> <span class="p">[{</span>
        <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">dataType</span><span class="p">:</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">dataTypeEnum</span><span class="p">.</span><span class="nx">string</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">mag</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">alias</span><span class="p">:</span> <span class="dl">"</span><span class="s2">magnitude</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">dataType</span><span class="p">:</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">dataTypeEnum</span><span class="p">.</span><span class="nx">float</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">alias</span><span class="p">:</span> <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">dataType</span><span class="p">:</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">dataTypeEnum</span><span class="p">.</span><span class="nx">string</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">location</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">dataType</span><span class="p">:</span> <span class="nx">tableau</span><span class="p">.</span><span class="nx">dataTypeEnum</span><span class="p">.</span><span class="nx">geometry</span>
    <span class="p">}];</span>

    <span class="kd">var</span> <span class="nx">tableSchema</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">earthquakeFeed</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">alias</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Earthquakes with magnitude greater than 4.5 in the last seven days</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">columns</span><span class="p">:</span> <span class="nx">cols</span>
    <span class="p">};</span>

    <span class="nf">schemaCallback</span><span class="p">([</span><span class="nx">tableSchema</span><span class="p">]);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Here’s what’s going on in the code:</p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">getSchema</code> function takes a <code class="language-plaintext highlighter-rouge">schemaCallback</code> parameter which is defined by the WDC API.</li>
  <li>The <code class="language-plaintext highlighter-rouge">cols</code> variable contains an array of JavaScript objects, where each object defines a single column in our table.
In this example, there are columns for magnitude, title, and location. Note that for each column you can
specify additional options. For example, the alias defines a friendly name that can appear in Tableau and the
columnRole determines whether a field is a measure or a dimension. The <code class="language-plaintext highlighter-rouge">id</code> can only contain alphanumeric values (a-z, A-Z, 0-9) and underscore characters (<code class="language-plaintext highlighter-rouge">_</code>). The identifiers cannot contain spaces, hyphens, or special characters. For more options, see <a href="/webdataconnector/docs/api_ref.html#webdataconnectorapi.columninfo" target="_blank">the API reference</a>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">tableSchema</code> variable defines the schema for a single table and contains a JavaScript object. Here, the value of
the <code class="language-plaintext highlighter-rouge">columns</code> property is set to the <code class="language-plaintext highlighter-rouge">cols</code> array defined earlier.</li>
  <li>The <code class="language-plaintext highlighter-rouge">schemaCallback</code> gets called when the schema is defined. The <code class="language-plaintext highlighter-rouge">schemaCallback</code> takes an array of table objects. In
this case, there is only table object (the <code class="language-plaintext highlighter-rouge">tableSchema</code> object defined above).</li>
</ul>

<p><strong>Note</strong>: The <a href="/webdataconnector/docs/api_ref">API Reference</a> describes the properties that you can define for the table
object and for each object in the table columns in more detail. For now, let’s plunge ahead to the exciting
part–getting the data!</p>

<h3 id="get-the-data">Get the data</h3>

<p>Once the schema is defined, you can begin getting data and passing it to Tableau.</p>

<p>Copy the following code and replace the placeholder <code class="language-plaintext highlighter-rouge">getData</code> function:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">myConnector</span><span class="p">.</span><span class="nx">getData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">table</span><span class="p">,</span> <span class="nx">doneCallback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nf">getJSON</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/4.5_week.geojson</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">feat</span> <span class="o">=</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">features</span><span class="p">,</span>
            <span class="nx">tableData</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="c1">// Iterate over the JSON object</span>
        <span class="nf">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">feat</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">tableData</span><span class="p">.</span><span class="nf">push</span><span class="p">({</span>
                <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">feat</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">id</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">mag</span><span class="dl">"</span><span class="p">:</span> <span class="nx">feat</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">properties</span><span class="p">.</span><span class="nx">mag</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span> <span class="nx">feat</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">properties</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">location</span><span class="dl">"</span><span class="p">:</span> <span class="nx">feat</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">geometry</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="nx">table</span><span class="p">.</span><span class="nf">appendRows</span><span class="p">(</span><span class="nx">tableData</span><span class="p">);</span>
        <span class="nf">doneCallback</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Whew! That’s a good-sized chunk of code. Let’s see what’s happening:</p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">getData</code> function takes two parameters: <code class="language-plaintext highlighter-rouge">table</code> and <code class="language-plaintext highlighter-rouge">doneCallback</code>. The <code class="language-plaintext highlighter-rouge">table</code> parameter is an object defined by
the WDC to which you can append data. The <code class="language-plaintext highlighter-rouge">doneCallback</code> signals to Tableau that you are done getting data.</li>
  <li>The jQuery <code class="language-plaintext highlighter-rouge">$.getJSON</code> function gets earthquake data from the USGS earthquake feed and uses a success handler to store the returned data in a response parameter (<code class="language-plaintext highlighter-rouge">resp</code>). (You can open the URL in a browser to see what the JSON data looks like.)</li>
  <li>The <code class="language-plaintext highlighter-rouge">for</code> loop iterates over the features in the JSON object and stores the data that we want in the <code class="language-plaintext highlighter-rouge">tableData</code> array.</li>
  <li>The <code class="language-plaintext highlighter-rouge">table.appendRows</code> function appends the <code class="language-plaintext highlighter-rouge">tableData</code> array to the <code class="language-plaintext highlighter-rouge">table</code> as a JavaScript object.</li>
</ul>

<h3 id="see-it-in-action">See it in action</h3>

<p>By now, you’re a pro at <a href="http://tableau.github.io/webdataconnector/docs/#run-sim">running the simulator</a>, so fire it up,
load your connector, and click <strong>Get Earthquake Data!</strong> like before. Now that we have a <code class="language-plaintext highlighter-rouge">getSchema</code> function properly
defined, you should see the schema displayed in the simulator.</p>

<p>The moment you’ve been waiting for is here! Click <strong>Fetch Table Data</strong> to run your <code class="language-plaintext highlighter-rouge">getData</code> function and display the results in a table.</p>

<p><img src="/webdataconnector/assets/wdc_sim_earthquake_geodata.png" alt="&quot;The earthquake data is displayed in a table on the simulator page.&quot;" /></p>

<blockquote>
  <p><strong>Note</strong> The location information for an earthquake is returned as a JSON object, which is why you might see <code class="language-plaintext highlighter-rouge">object Object</code> displayed in the simulator. Tableau 10.4 added support for geoJSON data, so while the simulator only knows you have some kind of JSON object, Tableau will have no trouble parsing the coordinates from the geometry data.</p>
</blockquote>

<p>To really see things working, <a href="http://tableau.github.io/webdataconnector/docs/wdc_use_in_tableau">open your connector in Tableau</a>:</p>

<p><img src="/webdataconnector/assets/wdc_tableau_earthquake_geo_json.png" alt="&quot;The earthquake data is displayed on a map in Tableau.&quot;" /></p>

<p>You did it! Nice work. But this is no time to rest on your laurels–<a href="/webdataconnector/docs/wdc_use_in_tableau">try your connector in Tableau</a>,
dig into the <code class="language-plaintext highlighter-rouge">Examples</code> directory to see more connectors, or read through the WDC documentation. You might want to start by
learning about <a href="/webdataconnector/docs/wdc_multi_table_tutorial">connectors with multiple tables</a>,
<a href="/webdataconnector/docs/wdc_incremental_refresh">incremental refresh</a>, and <a href="/webdataconnector/docs/wdc_authentication">authentication</a>. See the <a href="/webdataconnector/docs/wdc_multi_table_tutorial">WDC Multiple Table Tutorial</a> and <a href="/webdataconnector/docs/wdc_oauth_tutorial.html">WDC Node.js Proxy with OAuth Tutorial</a>.</p>

<p>Better yet, dive right in and create your own connector!</p>


            <!-- Footer -->
<footer>
    <div class="row">
            <hr class="footer-hr">
            <p>This site is open source. Suggestions and pull requests are welcome on our <a href="https://github.com/tableau/webdataconnector">GitHub page</a>.</p>
            <p><a href="https://www.tableau.com/en-us/legal" class="aLegal">LEGAL</a> <a href="https://www.salesforce.com/company/privacy/" class="aLegal">PRIVACY</a> &copy; 2003&ndash;<script>document.write(new Date().getFullYear())</script> TABLEAU SOFTWARE LLC. ALL RIGHTS RESERVED</p>
            <sub>Documentation last generated on: 2023-03-07 13:27:13 -0800</sub>
    </div>
</footer>

        </div>
    </div>
</body>

</html>
